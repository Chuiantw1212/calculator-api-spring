# Calculator API Spring

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Spring Boot çš„è²¡å‹™è¨ˆç®—æ©Ÿ APIï¼Œä¸»è¦åŠŸèƒ½ç‚ºè¤‡åˆ©è¨ˆç®— (Compound Interest)ã€‚
å°ˆæ¡ˆæ¡ç”¨ **MyBatis** ä½œç‚º ORM æ¡†æ¶ï¼Œä¸¦é€£æ¥è‡³ **Neon (PostgreSQL)** é›²ç«¯è³‡æ–™åº«é€²è¡Œæ•¸æ“šå­˜å–ã€‚

## ğŸ› ï¸ æŠ€è¡“æ£§ (Tech Stack)

* **Java**: 17
* **Framework**: Spring Boot 3.3.0 (é™ç‰ˆä»¥ç¢ºä¿ MyBatis ç›¸å®¹æ€§)
* **ORM**: MyBatis Spring Boot Starter 3.0.3
* **Database**: PostgreSQL (Neon Serverless)
* **Documentation**: SpringDoc OpenAPI (Swagger UI)
* **Tooling**: Maven, Lombok

## ğŸš€ å¿«é€Ÿé–‹å§‹ (Getting Started)

### 1. è³‡æ–™åº«è¨­å®š (Database Setup)
è«‹åœ¨ PostgreSQL è³‡æ–™åº«ä¸­åŸ·è¡Œä»¥ä¸‹ SQL ä»¥å»ºç«‹è³‡æ–™è¡¨ï¼š

```sql
CREATE TABLE IF NOT EXISTS calculation_records (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    principal DECIMAL(19, 2), -- æœ¬é‡‘
    rate DECIMAL(5, 4),       -- åˆ©ç‡
    years INT,                -- å¹´åˆ†
    result DECIMAL(19, 2),    -- è¨ˆç®—çµæœ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

```

### 2. ç’°å¢ƒè®Šæ•¸è¨­å®š (Configuration)

ç‚ºäº†è³‡å®‰è€ƒé‡ï¼Œæœ¬å°ˆæ¡ˆ **ä¸å°‡å¯†ç¢¼æ˜æ–‡å¯«å…¥** `application.yaml`ã€‚
å•Ÿå‹•å°ˆæ¡ˆå‰ï¼Œè«‹åœ¨ IDE (å¦‚ Eclipse) çš„ `Run Configurations` -> `Environment` ä¸­è¨­å®šä»¥ä¸‹è®Šæ•¸ï¼š

| è®Šæ•¸åç¨± (Variable) | èªªæ˜ (Description) | ç¯„ä¾‹å€¼ (Example) |
| --- | --- | --- |
| **DB_URL** | JDBC é€£ç·šå­—ä¸² | `jdbc:postgresql://<HOST>/neondb?sslmode=require` |
| **DB_USERNAME** | è³‡æ–™åº«å¸³è™Ÿ | `neondb_owner` |
| **DB_PASSWORD** | è³‡æ–™åº«å¯†ç¢¼ | `********` (è«‹å‹¿å¤–æµ) |

**æ³¨æ„ï¼š** `DB_URL` å¿…é ˆä»¥ `jdbc:postgresql://` é–‹é ­ã€‚

### 3. è¨­å®šæª”çµæ§‹ (application.yaml)

å°ˆæ¡ˆä½¿ç”¨ YAML æ ¼å¼ï¼Œè«‹å‹™å¿…ä½¿ç”¨ **ç©ºç™½éµ (Space)** ç¸®æ’ï¼Œåš´ç¦ä½¿ç”¨ Tab éµã€‚

```yaml
spring:
  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver

mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.en_chu.calculator_api_spring.model

```

## ğŸ“– API æ–‡ä»¶ (Swagger)

å°ˆæ¡ˆå•Ÿå‹•å¾Œï¼Œå¯é€éä»¥ä¸‹ç¶²å€æ¸¬è©¦ APIï¼š

* **Swagger UI**: `http://localhost:8888/swagger-ui/index.html`

## ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡æŒ‡ä»¤ (Troubleshooting & CLI)

### 1. é€£æ¥åŸ è¢«ä½”ç”¨ (Port 8888 already in use)

å¦‚æœé‡æ–°å•Ÿå‹•æ™‚ç™¼ç¾ Port è¢«ä½”ç”¨ï¼Œè«‹ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å¼·åˆ¶é—œé–‰èˆŠé€²ç¨‹ (Windows)ï¼š

**æŸ¥è©¢ä½”ç”¨ Port çš„ PID:**

```cmd
netstat -ano | findstr :8888

```

**å¼·åˆ¶çµ‚æ­¢é€²ç¨‹ (å°‡ 12345 æ›¿æ›ç‚ºæŸ¥è©¢åˆ°çš„ PID):**

```cmd
taskkill /F /PID 12345

```

### 2. Spring Boot ç‰ˆæœ¬ç›¸å®¹æ€§

* **å•é¡Œ**: è‹¥ä½¿ç”¨ Spring Boot 4.0.0+ï¼ŒMyBatis å¯èƒ½æœƒå‡ºç¾ `Property 'sqlSessionFactory' are required` éŒ¯èª¤ã€‚
* **è§£æ³•**: è«‹åœ¨ `pom.xml` å°‡ `<parent>` ç‰ˆæœ¬é™è‡³ `3.3.0`ï¼Œä¸¦åŸ·è¡Œ Maven Force Updateã€‚

### 3. Mapper æƒæéŒ¯èª¤

* **å•é¡Œ**: `Field required a bean of type '...Mapper' that could not be found`.
* **è§£æ³•**: ç¢ºä¿ä¸»ç¨‹å¼æœ‰åŠ å…¥ `@MapperScan("com.en_chu....mapper")` æˆ–è€…ç¢ºèª Package çµæ§‹ç¬¦åˆçˆ¶å­å±¤ç´šé—œä¿‚ã€‚