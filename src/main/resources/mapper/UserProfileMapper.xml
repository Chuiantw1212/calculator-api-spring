<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.en_chu.calculator_api_spring.mapper.UserProfileMapper">

	<update id="updateProfile">
        <![CDATA[
            UPDATE usr_profiles 
            SET 
                birth_date = #{birthDate},
                gender = #{gender},
                current_age = #{currentAge},
                life_expectancy = #{lifeExpectancy},
                marriage_year = #{marriageYear},
                career_insurance_type = #{careerInsuranceType},
                biography = #{biography},
                updated_at = CURRENT_TIMESTAMP
            WHERE id = #{id}                -- ðŸ“ æ¢ä»¶1: å‰ç«¯å‚³ä¾†çš„ ID
              AND firebase_uid = #{firebaseUid} -- ðŸ”’ æ¢ä»¶2: Token è§£æžå‡ºçš„ UID
        ]]>
    </update>

	<select id="selectByUid"
		resultType="com.en_chu.calculator_api_spring.entity.UserProfile">
        <![CDATA[
            SELECT 
                id,
                firebase_uid AS firebaseUid,
                birth_date AS birthDate,
                gender,
                current_age AS currentAge,
                life_expectancy AS lifeExpectancy,
                marriage_year AS marriageYear,
                career_insurance_type AS careerInsuranceType,
                biography,
                created_at AS createdAt,
                updated_at AS updatedAt
            FROM usr_profiles
            WHERE firebase_uid = #{firebaseUid}
        ]]>
    </select>

	<select id="selectById"
		resultType="com.en_chu.calculator_api_spring.entity.UserProfile">
        <![CDATA[
            SELECT 
                id,
                firebase_uid AS firebaseUid,
                birth_date AS birthDate,
                gender,
                current_age AS currentAge,
                life_expectancy AS lifeExpectancy,
                marriage_year AS marriageYear,
                career_insurance_type AS careerInsuranceType,
                biography,
                created_at AS createdAt,
                updated_at AS updatedAt
            FROM usr_profiles
            WHERE id = #{id}
        ]]>
    </select>

</mapper>