server:
  # 雲端環境通常會注入 PORT 環境變數，若無則預設 8080
  port: ${PORT:8080}

spring:
  application:
    name: calculator-api-spring
  
  datasource:
    # 資料庫連線維持使用環境變數，確保帳密不寫死在檔案中
    url: jdbc:postgresql://${DB_HOST:ep-holy-mud-a1v9v56m-pooler.ap-southeast-1.aws.neon.tech}:${DB_PORT:5432}/${DB_NAME:neondb}?sslmode=require
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    # HikariCP 連線池設定
    hikari:
      # 連線最大存活時間 (29分鐘)，避免被防火牆中斷
      max-lifetime: 1740000 
      # 從池中獲取連線的最大等待時間
      connection-timeout: 30000
      # 閒置連線超時 (10分鐘)
      idle-timeout: 600000

mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.en_chu.calculator_api_spring.model

# ✅ 正式環境：嚴格的 CORS 白名單
app:
  cors:
    allowed-origins:
      - https://enchu-8085a.web.app
      - https://enchu-8085a.firebaseapp.com
      - https://www.en-chu.com
      - https://planner-api-spring-592400229145.asia-east1.run.app

# 監控端點設定
management:
  endpoints:
    web:
      exposure:
        # 開放 health, info, 和 metrics
        include: health,info,metrics
  endpoint:
    health:
      # 顯示詳細健康資訊 (例如：資料庫連線狀態)
      show-details: always
      # 啟用 Liveness 和 Readiness 探測端點
      probes:
        enabled: true

# SpringDoc (Swagger) 設定
springdoc:
  # 讓 springdoc 自動建立並管理 actuator 群組
  show-actuator: true
